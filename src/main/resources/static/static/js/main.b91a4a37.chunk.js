(this.webpackJsonpwebapp=this.webpackJsonpwebapp||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(17),s=n.n(r),l=n(20),c=n(21),i=n(22),m=n(23),u=n(31),d=n(37),p=n(24),h=n(76),w=n.n(h),f=n(53),b=n.n(f),g=n(54),S=n.n(g),v=n(43),E=n(28),y=n(38),C=n(27),_=n(25),N=n(33),I=n(57),k="X",O="O",G={textAlign:"center"},T=function(e){Object(m.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).isNameGiven=function(){return""!==a.gamerName||(a.setState({showToast:!0}),a.toastText="Please enter your name!",!1)},a.newGameHandler=function(e){e.preventDefault(),a.isNameGiven()&&a.stablishNewGameConnection()},a.existingGameHandler=function(e){e.preventDefault(),a.isNameGiven()&&a.renderJoinGameModal()},a.sessionIdHandler=function(e){a.friendSessionId=e.target.value},a.nameInputHandler=function(e){a.gamerName=e.target.value,a.store.set("gamerName",a.gamerName)},a.stablishJoinGameConnection=function(){var e=new b.a("/tic-tac"),t=S.a.over(e);a.store.set("stompClient",t),t.connect({},(function(){a.ownSessionId=a.processSessionId(t),a.store.set("ownSessionId",a.ownSessionId),t.subscribe("/ws-user/"+a.ownSessionId+"/game-init",(function(e){a.handleGameInit(JSON.parse(e.body))})),t.subscribe("/ws-user/"+a.ownSessionId+"/error",(function(e){alert(JSON.parse(e.body).metadata)})),a.store.set("moveChar",O),t.send("/app/client-two-start",{},JSON.stringify({gamerName:a.gamerName,opponentSessionId:a.friendSessionId}))}))},a.stablishNewGameConnection=function(){var e=new b.a("/tic-tac"),t=S.a.over(e);a.store.set("stompClient",t),t.connect({},(function(){a.ownSessionId=a.processSessionId(t),a.store.set("ownSessionId",a.ownSessionId),t.subscribe("/ws-user/"+a.ownSessionId+"/game-init",(function(e){a.handleGameInit(JSON.parse(e.body))})),t.subscribe("/ws-user/"+a.ownSessionId+"/error",(function(e){alert(JSON.parse(e.body).metadata)})),a.store.set("moveChar",k),t.send("/app/client-one-start",{},JSON.stringify({gamerName:a.gamerName})),a.renderNewGameModal()}))},a.processSessionId=function(e){var t=e.ws._transport.url;return t=(t=(t=""===window.location.port?t.replace("ws://".concat(window.location.hostname,"/tic-tac/"),""):t.replace("ws://".concat(window.location.hostname,":").concat(window.location.port,"/tic-tac/"),"")).replace("/websocket","")).replace(/^[0-9]+\//,"")},a.handleGameInit=function(e){var t=e.opponentSessionId,n=e.opponentName,o=e.firstTurnSessionId;a.store.set("peerSessionId",t),a.store.set("opponentName",n),a.store.set("round",0),o===a.ownSessionId&&a.store.set("firstTurn",!0),a.setState({gameStarted:!0})},a.copySessionIdClipBoard=function(){var e=a.sid;console.log(e),e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),a.setState({copiedToClipboard:!0})},a.renderNewGameModal=function(){a.modalContent=o.a.createElement("div",null,o.a.createElement("p",{style:G},"Copy this Game ID and send it to your friend! ",o.a.createElement("br",null),o.a.createElement(E.a.Control,{type:"text",ref:function(e){return a.sid=e},style:G,readOnly:!0,value:a.ownSessionId}),document.queryCommandSupported("copy")&&o.a.createElement(_.a,{ref:function(e){return a.copyBtn=e},onClick:a.copySessionIdClipBoard,className:"m-1",variant:"outline-primary"},"Copy game ID"))),a.setState({showModal:!0,copiedToClipboard:!1})},a.renderJoinGameModal=function(){a.modalContent=o.a.createElement("div",null,o.a.createElement(y.a,null,o.a.createElement(C.a,null,o.a.createElement("div",{style:G},o.a.createElement(E.a,null,o.a.createElement(E.a.Label,null,"Your friend's game ID"),o.a.createElement(E.a.Control,{onChange:a.sessionIdHandler,type:"text",style:G,placeholder:"Enter game ID"}),o.a.createElement(_.a,{className:"m-1",onClick:function(){return a.stablishJoinGameConnection()},variant:"outline-primary"},"Start new game")))))),a.setState({showModal:!0})},a.state={gameStarted:!1,showModal:!1,showToast:!1,copiedToClipboard:!1},a.friendSessionId="",a.gamerName="",a.ownSessionId="",a.toastText="",a.store=e.store,a}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return!0===this.state.gameStarted?o.a.createElement(p.a,{to:"/game"}):o.a.createElement(v.a,null,o.a.createElement(y.a,{className:"".concat(w.a.vertical_center," justify-content-center")},o.a.createElement(C.a,{xs:"10",md:"8",lg:"6"},o.a.createElement("div",{style:G},o.a.createElement("h1",null,"Tic tac toe!!!"),o.a.createElement(_.a,{className:"m-1",variant:"outline-primary",size:"lg",onClick:this.newGameHandler},"Start new game"),o.a.createElement(_.a,{className:"m-1",variant:"outline-primary",size:"lg",onClick:this.existingGameHandler},"Join an existing game"),o.a.createElement(E.a,{className:"m-1"},o.a.createElement(E.a.Control,{size:"lg",onChange:this.nameInputHandler,style:G,type:"text",placeholder:"Enter your name"})),o.a.createElement(_.a,{className:"m-1",variant:"outline-primary",size:"lg",onClick:function(){return alert("Not yet implemented")}},"Start vs computer"),o.a.createElement(I.a,{onClose:function(){return e.setState({showToast:!1})},show:this.state.showToast,delay:1500,autohide:!0},o.a.createElement(I.a.Body,null,this.toastText))))),o.a.createElement(N.a,{show:this.state.showModal,onHide:function(){return e.setState({showModal:!1})}},o.a.createElement(N.a.Body,null,this.modalContent,this.state.copiedToClipboard&&o.a.createElement("p",{style:G},"Copied to clipboard!"))))}}]),n}(o.a.Component),R=Object(u.b)(T),J=n(26),j=n.n(J);function B(e){return o.a.createElement("h1",{style:{textAlign:"center"}}," You're playing against ",e.opponentName)}var D=function(e){Object(m.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={counter:3},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.counterInterval=setInterval((function(){1===e.state.counter&&clearInterval(e.counterInterval),e.setState((function(e){return{counter:e.counter-1}}))}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.counterInterval)}},{key:"render",value:function(){var e=this.state.counter;return 0===e&&this.props.timerReached(),o.a.createElement("div",null,0!==e&&o.a.createElement("h4",null,"Time: ",e))}}]),n}(o.a.Component),x=n(80),M="X",H="O",L=function(e){Object(m.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handlePeerDisconnected=function(){alert("Your opponent "+a.store.get("opponentName")+" has disconnected")},a.requestTurnInfo=function(){a.store.get("stompClient").send("/app/turn-info",{},JSON.stringify({opponentSessionId:a.store.get("peerSessionId")}))},a.handleGameResults=function(e){switch(e.gameResult){case"lost":a.showLost();break;case"draw":a.showDraw();break;case"win":a.showWin()}a.updateScoreBoard()},a.showWin=function(){a.modalContent=o.a.createElement("h1",null,"You won!!!"),a.setState({win:!0,myTurn:!1,gameEnd:!0,showResultsModal:!0}),a.resultOpponent="Lose",a.resultOwn="Win"},a.showLost=function(){a.modalContent=o.a.createElement("h1",null,"You lost!!!"),a.setState({lose:!0,myTurn:!1,gameEnd:!0,showResultsModal:!0}),a.resultOpponent="Win",a.resultOwn="Lose"},a.showDraw=function(){a.modalContent=o.a.createElement("h1",null,"Its a draw!!!"),a.setState({draw:!0,myTurn:!1,gameEnd:!0,showResultsModal:!0}),a.resultOwn="Draw",a.resultOpponent="Draw"},a.handleTurn=function(e){e.firstTurnSessionId===a.store.get("ownSessionId")&&a.setState({myTurn:!0})},a.handleGameData=function(e){var t=e.coordinate;a.updateBoard(t,!0),a.setState({myTurn:!0})},a.sendGameData=function(e){var t=a.store.get("stompClient"),n=a.store.get("peerSessionId");t.send("/app/game",{},JSON.stringify({opponentSessionId:n,coordinate:e}))},a.playerMove=function(e){var t=e.target.id.replace("block_","");a.updateBoard(t,!1),a.checkResults(),a.sendGameData(t),a.setState({myTurn:!1})},a.checkResults=function(){for(var e="",t=a.state.board,n=a.store.get("stompClient"),o=a.store.get("moveChar"),r=a.store.get("peerSessionId"),s=0;s<9;s+=3)if(a.checkLine(s,s+1,s+2)){e=t[s];break}for(var l=0;l<3;l++)if(a.checkLine(l,l+3,l+6)){e=t[l];break}a.checkLine(0,4,8)&&(e=t[0]),a.checkLine(2,4,6)&&(e=t[2]),e===o?(a.showWin(),n.send("/app/game-result",{},JSON.stringify({opponentSessionId:r,gameResult:"lost"})),a.updateScoreBoard()):""===e&&a.isBoardFull(t)&&(n.send("/app/game-result",{},JSON.stringify({opponentSessionId:r,gameResult:"draw"})),a.showDraw(),a.updateScoreBoard())},a.updateScoreBoard=function(){var e={round:a.store.get("round")+1,resultOwn:a.resultOwn,resultOpponent:a.resultOpponent},t=a.state.scoreTableRows;t.push(e),a.setState({scoreTableRows:t}),a.store.set("round",e.round)},a.isBoardFull=function(e){for(var t=0;t<e.length;t++)if(""===e[t])return!1;return!0},a.checkLine=function(e,t,n){var o=a.state.board;return o[e]===o[t]&&o[t]===o[n]&&o[e]===a.store.get("moveChar")},a.updateBoard=function(e,t){var n=a.state.board;n[e]=t?a.store.get("moveChar")===M?H:M:a.store.get("moveChar"),a.setState({board:n})},a.createBlocks=function(e){for(var t=[],n=a.state.board,r=0;r<n.length;r++)e?n[r]===H||n[r]===M?t.push(o.a.createElement("div",{id:"block_"+r,className:"".concat(j.a.block," ").concat(j.a.occupied)},n[r])):t.push(o.a.createElement("div",{id:"block_"+r,onClick:a.playerMove,className:j.a.block})):t.push(o.a.createElement("div",{id:"block_"+r,className:"".concat(j.a.block," ").concat(j.a.occupied)},n[r]));return t},a.startNewGame=function(){a.setState({board:["","","","","","","","",""],myTurn:!1,win:!1,lose:!1,draw:!1,gameEnd:!1}),a.requestTurnInfo()},a.requestStartNewGame=function(){var e=a.store.get("stompClient"),t=a.store.get("peerSessionId");e.send("/app/game-reset",{},JSON.stringify({opponentSessionId:t})),a.startNewGame()},a.onTimerReached=function(){var e=a.store.get("stompClient"),t=a.store.get("peerSessionId");a.showLost(),e.send("/app/game-result",{},JSON.stringify({opponentSessionId:t,gameResult:"win"})),a.updateScoreBoard()},a.state={board:["","","","","","","","",""],opponentName:"",myTurn:!1,win:!1,lose:!1,draw:!1,gameEnd:!1,showResultsModal:!1,gameError:!1,scoreTableRows:[]},a.modalContent="",a.store=e.store,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.store.get("stompClient"),n=this.store.get("ownSessionId"),a=this.store.get("firstTurn");t?(a&&this.setState({myTurn:!0}),t.subscribe("/ws-user/"+n+"/game",(function(t){e.handleGameData(JSON.parse(t.body))})),t.subscribe("/ws-user/"+n+"/turn-info",(function(t){e.handleTurn(JSON.parse(t.body))})),t.subscribe("/ws-user/"+n+"/game-result",(function(t){e.handleGameResults(JSON.parse(t.body))})),t.subscribe("/ws-user/"+n+"/game-reset",(function(){alert("New game started by "+e.state.opponentName),e.startNewGame()})),t.subscribe("/ws-user/"+n+"/peer-disconnected",(function(){e.handlePeerDisconnected()})),this.setState({opponentName:this.store.get("opponentName")})):this.setState({gameError:!0})}},{key:"render",value:function(){var e=this,t=this.state,n=t.myTurn,a=t.gameEnd,r=t.opponentName;return t.gameError?o.a.createElement(p.a,{to:"/"}):o.a.createElement("div",null,o.a.createElement(B,{opponentName:r}),o.a.createElement(v.a,null,o.a.createElement(y.a,{className:"justify-content-center"},o.a.createElement(C.a,{xs:"10",sm:"6",lg:"4"},o.a.createElement("div",{className:j.a.container},n&&!a&&o.a.createElement("div",null,o.a.createElement("h1",null,"Its your turn"),o.a.createElement(D,{timerReached:this.onTimerReached})),!n&&!a&&o.a.createElement("h1",null,"Its ",r,"'s turn"),o.a.createElement("div",{className:j.a.play_area},this.createBlocks(this.state.myTurn)),a&&o.a.createElement(_.a,{variant:"outline-success",className:"m-3",onClick:this.requestStartNewGame},"Start a new game"),o.a.createElement("h4",null,"Score"),o.a.createElement(x.a,{bordered:!0,size:"sm",variant:"dark"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Round"),o.a.createElement("th",null,this.store.get("gamerName")),o.a.createElement("th",null,this.store.get("opponentName")))),o.a.createElement("tbody",{ref:function(t){return e.tableScoreBody=t}},this.state.scoreTableRows.map((function(e){return o.a.createElement("tr",null,o.a.createElement("td",null,e.round),o.a.createElement("td",null,e.resultOwn),o.a.createElement("td",null,e.resultOpponent))})))))))),o.a.createElement(N.a,{show:this.state.gameEnd&&this.state.showResultsModal,onHide:function(){return e.setState({showResultsModal:!1})}},o.a.createElement(N.a.Body,null,this.modalContent)))}}]),n}(o.a.Component),W=Object(u.b)(L),z=function(e){Object(m.a)(n,e);var t=Object(i.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return o.a.createElement(d.a,null,o.a.createElement(p.d,null,o.a.createElement(p.b,{exact:!0,path:"/",component:R}),o.a.createElement(p.b,{exact:!0,path:"/game",component:W}),o.a.createElement(p.b,{component:P})))}}]),n}(o.a.Component),P=function(){return o.a.createElement("div",null,o.a.createElement("h3",null,"404 - Not found"),o.a.createElement(d.b,{to:"/"},"Back to game"))},q=Object(u.a)(z);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(126);s.a.render(o.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},26:function(e,t,n){e.exports={play_area:"GameComponent_play_area__3juk5",block:"GameComponent_block__2CsDk",occupied:"GameComponent_occupied__18t2R",block_0:"GameComponent_block_0__3vmEi",block_1:"GameComponent_block_1__2P8ke",block_2:"GameComponent_block_2__fvfJb",block_3:"GameComponent_block_3__1y80p",block_6:"GameComponent_block_6__W9tpw",block_7:"GameComponent_block_7__2eyd9",block_8:"GameComponent_block_8__3DPrh",block_5:"GameComponent_block_5__3PHjz",container:"GameComponent_container__2T2J_"}},76:function(e,t,n){e.exports={vertical_center:"IntroComponent_vertical_center__1SCGZ"}},81:function(e,t,n){e.exports=n(127)}},[[81,1,2]]]);
//# sourceMappingURL=main.b91a4a37.chunk.js.map